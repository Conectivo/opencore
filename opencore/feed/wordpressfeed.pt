<tal:vars define="global fdata view/handle_request;" />

<div class="oc-widget oc-widget-feed oc-home-column"
     tal:condition="view/feed | nothing">
  <h2 class="oc-feed-title">
    <a tal:attributes="href view/feed/feed/link"
       tal:content="view/title">
    </a>
  </h2>
  <!-- view/feed/link -->
  <ul class="oc-feed-list">
    <li class="oc-feed-item oc-clearAfter" 
	tal:repeat="feeditem
		    view/feed/entries">
      <div tal:define="author feeditem/author; 
      profile python:view.memfolder_url(author) + '/profile';" >
	<a tal:attributes="href profile">
	<img tal:attributes="src feeditem/author_portrait" />
	</a>	
	<h3 class="oc-feed-item-title">
	  <a tal:attributes="href feeditem/link"
	     tal:content="feeditem/title" />	  
	</h3>

	<div tal:omit-tag tal:condition="not:repeat/feeditem/start">
	  <a tal:condition="python: feeditem.comment_string != 'No Comments'" 
	     tal:attributes="href feeditem/comments"
	     tal:content="feeditem/comment_string">
	    12 comments
	  </a>
	</div>

	<p class="oc-feed-item-data oc-discreetText">
	   <span tal:replace="feeditem/byline | default">
	     by
	   </span>	   
	   <a tal:attributes="href profile"
	      tal:content="author" />,
	   <span tal:define="date feeditem/date"
		 tal:replace="python:view.pretty_date(date)" />   
	</p>

	<!-- display the summary for the first item -->
	<div tal:omit-tag tal:condition="repeat/feeditem/start">
	  <p tal:condition="repeat/feeditem/start"
	     tal:content="structure feeditem/summary">
	    Lorem ipsum dolor
	  </p>
	  <p tal:condition="python: feeditem.comment_string != 'No Comments'">
	    <a tal:attributes="href feeditem/comments"
	       tal:content="feeditem/comment_string">
	      12 comments
	    </a>
	  </p>
	</div>
	
      </div>
    </li>
  </ul>
</div>

