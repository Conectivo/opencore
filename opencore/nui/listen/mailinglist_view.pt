<html i18n:domain="opencore" metal:use-macro="here/@@standard_macros/master">
  <head>
    <title metal:fill-slot="title" tal:content="string:${view/context/Title} - ${view/area/Title}" />
  </head>
  <body>
    <div metal:fill-slot="content">
      <tal:vars define="can_subscribe view/canSubscribe;
                        subscribed view/isSubscribed;
                        isAnon not: view/loggedin">
        <div metal:use-macro="here/@@listen_macros/bcrumb"/>
        <div metal:use-macro="here/@@listen_macros/tabs"/>
        <div id="oc-content-main">
          <dl class="oc-plainList">
            <dt i18n:translate="mailinglist_view_title">Title</dt>
            <dd tal:content="context/Title" />
            <tal:description tal:define="desc context/Description" tal:condition="desc">
              <dt i18n:translate="mailinglist_view_desc">Description</dt>
              <dd class="oc-headingContext" tal:content="desc" />
            </tal:description>
            <tal:email tal:condition="view/loggedin">
              <dt i18n:translate="mailinglist_view_address" id="listaddress">
                Address
              </dt>
              <dd tal:content="view/address">
                address@example.com
              </dd>
            </tal:email>
            <tal:managers tal:condition="view/list_managers">
              <dt i18n:translate="mailinglist_view_managers" id="listmanagers">
                Managers
              </dt>
              <dd>
                <ul class="oc-plainList">
                  <li tal:repeat="manager view/list_managers">
                    <span tal:replace="manager" />
                  </li>
                </ul>
              </dd>
            </tal:managers>
            <dt i18n:translate="mailinglist_view_type" id="list-type">
              Type
            </dt>
            <dd tal:content="view/list_type">
              List type
            </dd>
            <dt i18n:translate="mailinglist_view_archive" id="archival-state">
              Archive
            </dt>
            <dd>
              <span tal:content="view/archived">
                Messages to this list are archived
              </span>
              <a tal:condition="view/is_archived" tal:attributes="href python:'%s/archive' % view.context.absolute_url()" i18n:translate="mailinglist_view_archive">
                View archive.
              </a>
            </dd>
            <dt i18n:translate="mailinglist_view_contact">
              Contact
            </dt>
            <dd id="manager_email" tal:content="view/manager_email" i18n:translate="mailinglist_view_inquiries">
              Please direct inquiries about this list to listmanager@example.com.
            </dd>
          </dl>
          <div class="oc-listen-details-subscribe oc-boxy oc-clearAfter">
            <p tal:condition="python:isAnon or not can_subscribe" id="unsub-instructions" i18n:translate="mailinglist_view_to_unsubscribe">
              To unsubscribe from this list send an email to the list with the subject
              "<span tal:replace="view/unsubscribe_keyword" i18n:name="sunsubscribe_keyword" />"
              and an empty body.
            </p>
      
            <form name="subscription-form" id="subscription-form"
              tal:define="errors view/errors|nothing;
                          isPending view/isPending"
              action="." tal:attributes="action request/ACTUAL_URL">
              <tal:member condition="python:can_subscribe and not isAnon and not isPending">
                <h2 i18n:translate="mailinglist_view_sub_form_heading">Subscription status</h2>
                <p id="subscription-status" tal:condition="subscribed" i18n:translate="mailinglist_view_subscribed">
                  You are currently <strong>subscribed</strong> to this list.
                </p>
                <p id="subscription-status" tal:condition="not:subscribed" i18n:translate="mailinglist_view_not_subscribed">
                  You are currently <strong>not subscribed</strong> to this list.
                </p>
                <div class="oc-actions">
                  <input type="submit" name="unsubscribe_member" value="Unsubscribe"
                    tal:condition="subscribed" i18n:attributes="value mailinglist_view_unsub_button" />
                  <input type="submit" name="subscribe_member" value="Subscribe"
                    tal:condition="not:subscribed" i18n:attributes="value mailinglist_view_sub_button" />
                </div>
              </tal:member>
              <tal:anon tal:define="error errors/email_address|nothing"
                        condition="python:isAnon and can_subscribe">
                <p id="subscription-status" i18n:translate="mailinglist_view_enter_email">
                  To subscribe to the list enter your email in the field below.
                </p>
                <fieldset 
                  tal:attributes="class python:'oc-form-fieldBlock' + (error and ' error' or '')">
                  <label for="email_address" i18n:translate="mailinglist_view_email_add"><strong>Email address:</strong></label>
                  <input type="text" value="" name="email_address"
                  tal:attributes="value request/email_address|nothing" />
                  <span class="oc-actions">
                    <input type="submit"
                    class="context"
                    name="subscribe_email"
                    value="Subscribe Address"
                    i18n:attributes="value mailinglist_view_sub_email_button" />
                  </span>
                  <span class="oc-discreetText" style="white-space: nowrap;" tal:condition="error" tal:content="error"/>
                </fieldset>
              </tal:anon>
              <tal:pending tal:condition="python: isPending">
              <h2 i18n:translate="mailinglist_view_sub_pending">Subscription pending</h2>
                <p>
                  Your subscription request is pending moderation by the list manager. 
                  <span id="manager_email" tal:content="view/manager_email" i18n:name="manager_email">
                    Please direct inquiries to listmanager@example.com.
                  </span>
                </p>
              </tal:pending>
            </form>
          </div><!-- end oc-listen-details-subscribe -->
        </div><!-- content-main -->
      </tal:vars>
    </div><!-- content-fill-slot -->
  </body>
</html>
