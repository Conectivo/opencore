<tal:vars define="data view/viewed_member_info">

<html metal:use-macro="here/@@standard_macros/master">
  <body>

    <div metal:fill-slot="content">

<div class="oc-headingBlock">
  <h1>Your account</h1>
  <p class="oc-headingContext">View and manage your project memberships and account settings</p>
</div>
  
<div id="oc-content-main">
  
  <div class="oc-widget oc-widget-invite"
       tal:define="n_updates view/n_updates"
       >
    <tal:has_updates condition="n_updates">
      <div class="oc-headingBlock">
        <h2 tal:content="string:Latest updates (${n_updates})" />
      </div>
      <!-- currently create 2 separate list groups:
           status info messages,
           projects inviting user -->
      <!-- invitations -->
      <ul tal:define="invitations view/invitations"
          tal:condition="invitations"
          class="oc-invite-list">
        <form name="invitation-form" action="preferences">
          <tal:for repeat="projinfo invitations">
            <li class="oc-invite oc-boxy oc-clearAfter"
                tal:define="proj_id projinfo/proj_id"
                tal:attributes="id string:${proj_id}_invitation">
              <div class="oc-avatar">
                <!-- XXX is this the project avatar? proj admin avatar? -->
                <img src="" />
              </div>
              <p class="oc-invite-content">
                <a href="" tal:attributes="href string:${view/portal_url}/projects/${proj_id}" tal:content="projinfo/title">Animal Campaign</a> 
            has invited you to become a member
              </p>
              <ul class="oc-actions oc-invite-actions oc-actionClose"
                  tal:define="url request/ACTUAL_URL">
                <li tal:repeat="action view/invitation_actions">
                  <a tal:attributes="href string:${url}?task=${proj_id}_${action}Invitation;
                                     class string:oc-actionLink oc-js-actionLink oc-choose${action}"
                     tal:content="action"
                     />
                </li>
              </ul>
            </li>
          </tal:for>
        </form>
      </ul>
      <!-- info messages -->
      <ul tal:define="infomsgs view/infomsgs"
          tal:condition="infomsgs"
          class="oc-invite-list">
        <form name="info-form" action="preferences">
          <tal:for repeat="infomsg infomsgs">
            <li class="oc-invite oc-boxy oc-clearAfter"
                tal:define="idx python: infomsg[0];
                            msg python: infomsg[1]"
                tal:attributes="id string:close_${msg}"
                >
              <tal:info_msg define="idx python: infomsg[0];
                                    msg python: infomsg[1]">
                <div class="oc-avatar">
                  <img src="" />
                </div>
                <p class="oc-invite-content"
                   tal:content="structure msg" />
                <a href="#" title="Close" class="oc-actionClose oc-actionLink"
                   tal:attributes="href string:${request/ACTUAL_URL}?task=${idx}_close"
                   >Close</a>
              </tal:info_msg>
            </li>
          </tal:for>
        </form>
      </ul>
    </tal:has_updates>
    <tal:no_updates condition="not: n_updates">
      <!-- XXX -->
      <h1>What to put here with no updates?</h1>
    </tal:no_updates>
    <!-- static data -->
    <!--ul class="oc-invite-list">
      <li class="oc-invite oc-boxy oc-clearAfter">
          <div class="oc-avatar">
            <img src="" />
          </div>
          <p class="oc-invite-content">
            You have been accepted to <a href="">Turkey Time</a> 
          </p>
          <a href="#" title="Close" class="oc-actionClose  oc-actionLink">Close</a>
        </li>
      <li class="oc-invite oc-boxy oc-clearAfter">
          <div class="oc-avatar">
            <img src="" />
          </div>
          <p class="oc-invite-content">
            You have been denied membership to <a href="">Chicken Adidas</a> 
          </p>
          <a href="#" title="Close" class="oc-actionClose  oc-actionLink">Close</a>
        </li>
      <li class="oc-invite oc-boxy oc-clearAfter">
        <div class="oc-avatar">
          <img src="" />
        </div>
        <p class="oc-invite-content">
          <a href="">Animal Campaign</a> 
      has invited you to become a member
        </p>
        <ul class="oc-actions oc-invite-actions oc-actionClose">
          <li><a href="" class="oc-actionLink oc-chooseAccept">Accept</a></li>
          <li><a href="" class="oc-actionLink oc-chooseReject">Deny</a></li>
          <li><a href="" class="oc-actionLink oc-chooseIgnore">Ignore</a></li>
        </ul>
      </li>
      <li class="oc-invite oc-boxy oc-clearAfter">
        <div class="oc-avatar">
          <img src="http://www.3dvalley.com/tutorials/modeling_basketball_clip_image037.gif" />
        </div>
        <p class="oc-invite-content">
          <a href="">Animal Campaign for a really important animal named Charlie</a> 
      has invited you to become a member
        </p>
        <ul class="oc-actions oc-invite-actions oc-actionClose">
          <li><a href="" class="oc-actionLink oc-chooseAccept">Accept</a></li>
          <li><a href="" class="oc-actionLink oc-chooseReject">Deny</a></li>
          <li><a href="" class="oc-actionLink oc-chooseIgnore">Ignore</a></li>
        </ul>
      </li>
    </ul-->
  </div><!-- end .widget-invitations -->
  

  <tal:projects_table define="projinfos view/projects_for_user">
  <div class="oc-widget oc-widget-dataTable oc-clearAfter"
       tal:condition="projinfos"
       >
    <div class="oc-headingBlock">
      <h2 class="oc-toggleFold">
        Projects you belong to (<span id="num_projs" tal:content="python: len(projinfos)" />)
      </h2>
    </div><!-- end .headingBlock -->
  
    <form class="" action="preferences">
    <table id="" class="oc-dataTable" cellpadding="0" cellspacing="0">
      <thead>
        <tr>
          <th class="" style="width: 10px;" scope="col"><input class="oc-checkAll" type="checkbox" /></th>
          <th class="oc-columnSortable" style="width: 200px;" scope="col">Project </th>
          <th class="oc-columnSortable" scope="col">Role</th>
          <th class="oc-columnSortable" scope="col">Since</th>
          <th class="oc-columnSortable" scope="col">Listed</th>
          <th class="oc-columnAction" scope="col">Actions</th>
        </tr>
      </thead>
      <tbody id="projinfos_for_user">
        <tal:for repeat="projinfo projinfos">
          <tal:var define="proj_id projinfo/proj_id">
	    <tal:macro metal:use-macro="view/project_row/macros/project_row" />
          </tal:var>
        </tal:for>
        <!-- keep in a sample member with static data -->
        <!--tr>
          <td><input type="checkbox" /></td>
          <td class="oc-dataTable-row-title"><a href="">Animal Campaign for a poor little sick kittie named Fatty</a></td>
            <td id="oc-liveEdit_8" class="oc-liveItem">
      <span id="oc-liveEdit_8_value" class="oc-liveItem-value oc-liveItem-directEdit oc-liveItem-directSelect">not set</span>
      <div id="oc-liveEdit_8_form" class="oc-liveItem-editForm">
        <select>
          <option>-- not set --</option>
          <option>Active</option>
          <option>Banned</option>
        </select>
        <a href="#" class="oc-liveItem_cancel">Cancel</a>
      </div>
          </td>
      <td>5:30am</td>
          <td id="" class="oc-liveItem">
      <span id="" class="oc-liveItem-value oc-liveItem-directEdit oc-liveItem-directSelect">not set</span>
      <div id="" class="oc-liveItem-editForm">
        <select>
          <option>-- not set --</option>
          <option>Member</option>
          <option>Administrator</option>
          <option>Administrator2</option>
          <option>Administrator3</option>
        </select>
        <a href="#" class="oc-liveItem_cancel">Cancel</a>
      </div>
          </td>
          <td>
            <ul class="oc-actions oc-dataTable-row-actions">
              <li><a href="#">Leave</a></li>
            </ul>
          </td>
        </tr-->
      </tbody>
    </table>
    <ul class="oc-actions oc-dataTable-actions">
      <li>
        <button type="submit" name="task" value="batch:check_leave"
                class="oc-button oc-chooseThis oc-js-actionButton">Leave projects</button>
      </li>
      <noscript>
       <li>
         <button type="submit" name="task" value="batch:check_change-listing"
                 class="oc-button">Change listing</button>
       </li>
      </noscript>
    </ul>
  </form>
  </div><!-- end .widget-table -->

  <!-- XXX -->
    <h1 tal:condition="not: projinfos">Display anything with no projects? Maybe a link to join?</h1>

  </tal:projects_table>

</div><!-- end #oc-content-main -->

<div id="oc-content-sidebar">
  <div class="oc-getstarted">
    <h2>Next steps&hellip;</h2>
    <ol class="oc-getstarted-list">
        <li>
          <h3><a href="profile-edit">1. Personalize your profile</a></h3>
          <p class="oc-discreetText">Tell everyone a little about yourself.</p>
        </li> 
        <li>
          <h3><a href="#">2. Post a photo of yourself</a></h3>
          <p class="oc-discreetText">Tell everyone a little about yourself.</p>
        </li>
        <li>
          <h3><a href="#">3. Customize your homepage</a></h3>
          <p class="oc-discreetText">Tell everyone a little about yourself.</p>
        </li>
        <li>
          <h3><a tal:attributes="href string:${context/portal_url}/projects">4. Join or start a project</a></h3>
          <p class="oc-discreetText">Tell everyone a little about yourself.</p>
        </li>
    </ol>
  </div>
  <div class="oc-boxy">
    <h2>Account settings</h2>
    <a href="profile-edit">Edit profile</a>
    <form class="oc-expander">
      <fieldset>
        <legend class="oc-legend-label">
          <a href="#" class="oc-expander-link">Change email</a>
        </legend>
        <ul class="oc-expander-content oc-plainList">
          <li>
            <label for="email">Email</label><br />
            <input type="text" id="email" tal:attributes="value data/email"/>
          </li>
          <li class="oc-form-fieldBlock oc-smallText">
            <input type="checkbox" class="oc-input-typeCheck" id="email_hide" />
            <label for="email_hide">Hide email address by default?</label>
          </li>
          <li>
            <button type="submit" 
              name="update:boolean" 
              value="True" 
              class="oc-button oc-chooseThis">
              Change
            </button>
          </li>
        </ul>
      </fieldset>
    </form>
    <form class="oc-expander">
      <fieldset>
        <legend class="oc-legend-label">
          <a href="#" class="oc-expander-link">Change password</a>
        </legend>
        <ul class="oc-expander-content oc-plainList">
          <li>
            <label for="passwd_curr">Current password</label><br />
            <input type="password" id="passwd_curr" />
          </li>
          <li>
            <label for="passwd_new">New password</label><br />
            <input type="password" id="passwd_new" />
          </li>
          <li>
            <label for="passwd_new_confirm">Confirm new password</label><br />
            <input type="password" id="passwd_new_confirm" />
          </li>
          <li>
            <button type="submit" 
              name="update:boolean" 
              value="True" 
              class="oc-button oc-chooseThis">
              Change
            </button>
          </li>
        </ul>
      </fieldset>
    </form>
  </div>
  
</div><!-- end #oc-content-sidebar -->


  </div><!-- content-fill-slot -->
</body>
</html>
</tal:vars>
