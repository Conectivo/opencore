<tal:vars define="global proj view/project_info;
                  global team_manage_macros view/team_manage_macros/macros" />

<html metal:use-macro="here/@@standard_macros/master">
  <body>
    <div metal:fill-slot="content">
    
    <div class="oc-headingBlock">
      <h1>Team Management</h1>
      <p class="oc-headingContext"
         tal:define="nmembers python:len(view.active_mships);
                     npending python:len(view.pending_mships)"
         tal:content="string:$nmembers members, $npending pending memberships" />
    </div>
    
    <div id="oc-content-main">
      <div id="oc-security-settings" class="oc-boxy">
        <h2>Your security settings</h2>
        <p>
          Currently only your project members can view the content
          of your project.  Only administrators can add new features
          to the site.
        </p>
        <p><a href="preferences">Change security settings</a></p>
      </div>

        
        <tal:pendingrequests
           define="item_heading string:Users requesting to join your project;
                   item_type string:request;
		   item_collection view/pending_requests;
                   num_items python:len(item_collection);"
           condition="item_collection">
	  <metal:pending
             use-macro="team_manage_macros/pendinglist" />
	   </tal:pendingrequests>

        <tal:pendinginvitations
           define="item_heading string:Pending membership invitations;
                   item_type string:invitation;
		   item_collection view/pending_invitations;
                   num_items python:len(item_collection);"
           condition="item_collection">
	  <metal:pending
             use-macro="team_manage_macros/pendinglist" />
        </tal:pendinginvitations>

        <tal:pendingemailinvites
           define="item_heading string:Pending email invitations;
                   item_type string:email-invite;
                   item_collection view/pending_email_invites;
                   num_items python:len(item_collection);"
           condition="item_collection">
          <metal:emailinvites
             use-macro="team_manage_macros/pendinglist" />
        </tal:pendingemailinvites>

        <tal:memberships>
          <metal:mshiplist use-macro="team_manage_macros/mshiplist" />
        </tal:memberships>
    </div><!-- end #oc-content-main -->
    
    <div class="oc-content-sidebar">
      <div class="oc-headingBlock">
        <h2>Invite new members</h2>
      </div>
      <hr />
      <h3>Search for members</h3>

      <p class="oc-discreetText">Search and invite existing members</p>

      <metal:search-members use-macro="team_manage_macros/search-members" />
      <hr />

      <h3>or</h3>
      <h3>Invite by email address</h3>
      <p class="oc-discreetText">Send an email to invite people to join</p>
      <form id="oc-inviteByEmail" name="oc-inviteByEmail"
            tal:attributes="action view/request/ACTUAL_URL"
            method="POST">
        <textarea id="email-invites" name="email-invites"
                  tal:content="view/request/form/email-invites | nothing" />
        <p class="oc-discreetText">Comma separated</p>
        <input type="submit" name="task|email-invites" value="Send"
                class="oc-button" />
      </form>
    </div><!-- end #oc-content-sidebar -->
    
    </div><!-- end content-fill-slot -->
  </body>
</html>
