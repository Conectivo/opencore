<tal:vars tal:define="attachments python:here.getFolderContents(contentFilter = {'portal_type' : ['FileAttachment']});
                      Iterator python:modules['Products.CMFPlone'].IndexIterator;
                      lockable python:hasattr(here, 'wl_isLocked');
                      errors python: options.get('errors', {});
                      isLocked python:lockable and here.wl_isLocked();
                      member python:here.portal_membership.getAuthenticatedMember();
                      portal python:context.portal_url.getPortalObject();
                      portal_url here/portal_url;
                      tabindex python:Iterator(pos=7000);
                      ">

<html metal:use-macro="here/@@standard_macros/master">
  <head>
    <metal:do metal:fill-slot="link" >
      <link rel="stylesheet" href="++resource++css/kupustyles.css" media="all"/>
      <link rel="stylesheet" href="++resource++css/kupuplone.css" media="all"/>
      <link rel="stylesheet" href="++resource++css/kupudrawerstyles.css" media="all"/>
    </metal:do>
    <metal:do metal:fill-slot="script" >
      <script src="++resource++javascripts/sarissa.js"></script>
      <script src="++resource++javascripts/sarissa_ieemu_xpath.js"></script>
      <script src="++resource++javascripts/kupunoi18n.js"></script>
      <script src="++resource++javascripts/kupuhelpers.js"></script>
      <script src="++resource++javascripts/kupueditor.js"></script>
      <script src="++resource++javascripts/kupubasetools.js"></script>
      <script src="++resource++javascripts/kupuloggers.js"></script>
      <script src="++resource++javascripts/kupucontentfilters.js"></script>
      <script src="++resource++javascripts/kupucontextmenu.js"></script>
      <script src="++resource++javascripts/kupuploneeditor.js"></script>
      <script src="++resource++javascripts/kupuploneinit.js"></script>
      <script src="++resource++javascripts/kupusourceedit.js"></script>
      <script src="++resource++javascripts/kupudrawers.js"></script>
    </metal:do>
  </head>
  <body>
    <div metal:fill-slot="content">

      <div id="oc-content-main" class="oc-content-main-fullWidth">

        <div class="oc-wiki">

          <form name="edit_form"
            method="post"
            enctype="multipart/form-data"
            class="enableUnloadProtection"
            tal:attributes="action string:${here/absolute_url}/@@update">
            
              <ul class="oc-headingBlock oc-wiki-headingBlock oc-bcrumb">
                <li class="oc-liveItem">
                  <span class="oc-liveItem-value">
                    <span class="oc-bcrumb-current" tal:content="context/Title" />
                    <a href="#" class="oc-liveItem_showForm">RENAME</a>
                  </span>
                  <div class="oc-liveItem-editForm">
                    <input name="title" type="text" tal:attributes="value string:${context/Title}" /> <a href="#" class="oc-liveItem_cancel">Cancel</a>
                  </div>
                </li>
              </ul>

            <div metal:use-macro="here/@@wiki_macros/tabs"/>

            <div class="oc-wiki-edit" >

              <div class="oc-wiki-edit-content">
                <input type="hidden" name="submitted" value="1"/>
                <metal:fieldMacro use-macro="python:here.widget('text', mode='edit')"/>
              </div><!-- end .oc-wiki-edit-content" --> 
 
              <div class="oc-expander">
                <a href="#oc-wiki-comment" class="oc-expander-link">Version note</a>
                <div class="oc-expander-content">
		              <textarea name="comment" id="comment" rows="3" cols="60"></textarea>
                </div><!-- end expander-content -->
              </div><!-- end expander -->
            
              <ul class="oc-actions oc-wiki-actions">
                <li><input type="submit" value="Save" class="oc-button oc-chooseThis" /></li>
                <li>or <a href="" tal:attributes="href context/absolute_url">cancel</a></li>
              </ul>  
              
            </div><!-- end .oc-wiki-edit -->

          </form>
        </div><!-- end .oc-wiki -->


        <div class="oc-options oc-wiki-edit-options">

          <div tal:attributes="class python:attachments and 'oc-expander oc-expander-open' or 'oc-expander'">
            <a href="#oc-wiki-manageAttachments" class="oc-expander-link">Manage attachments</a>
            <div class="oc-expander-content">
              <h4>Current attachments:</h4>
                <ol class="oc-attachments" id="oc-wiki-attachments">
                  <tal:block condition="nocall:attachments">
                    <tal:repeat repeat="attachment attachments">
                      <li metal:use-macro="here/@@wiki_macros/attachment"/>
                    </tal:repeat>
                  </tal:block>
                </ol>

              <fieldset>
                <legend><h4>Upload a new file:</h4></legend>
                <form metal:use-macro="here/@@wiki_macros/upload"/>
              </fieldset>

            </div><!-- end expander-content -->
          </div><!-- end expander -->
        </div><!-- end .oc-options -->
      </div><!-- end #oc-content-main -->        
    </div><!-- end content slot -->
  </body>
</html>

</tal:vars>
