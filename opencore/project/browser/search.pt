<html i18n:domain="opencore" metal:use-macro="here/@@standard_macros/master">
  <head>
    <title metal:fill-slot="title"
           tal:content="string:${view/project_noun/title}s - ${view/portal_title}" />
  </head>
  <body>
    <div metal:fill-slot="content">
      <div id="oc-content-main"
	   tal:define="batch view/batched_results">

	<tal:got_results condition="batch">

<!-- things we can remove from macro caller:
 * batch_base_url
 * start, end, sequence_length
 * search_prefix
-->
<!-- the minimum necessary structure here is

<div class="oc-lineup">
  <div class="oc-lineup-sorter">
    (pagination)
    (sort)
  </div>
  <ol class="oc-lineup-list">
    <li class="oc-lineup-item" />
  </ol>
</div>

Is this all really necessary?  Also, can it be merged with the similar
people/projects searchresults templates somehow?
-->

	  <div class="oc-lineup">
            <div class="oc-lineup-sorter">
              <div metal:use-macro="here/@@nui_batch_macros/pagination"/>	    
              <div metal:use-macro="here/@@nui_batch_macros/sort_widget"/>
            </div>

	    <ol class="oc-lineup-list">
	      <li class="oc-lineup-item" tal:repeat="item batch">
		<h3>
		  <img tal:attributes="src item/getIcon" />
		  <a tal:attributes="href item/getURL" tal:content="item/Title" />
		</h3>
		<span class="oc-discreetText">
		  <tal:has_updated_author define="userid item/lastModifiedAuthor" condition="userid">
                    modified by
                    <a tal:attributes="href string:${context/portal_url}/people/${userid}/profile" 
                       tal:define="mem_title nocall:context/@@oc-utils/member_title"
                       tal:content="python:mem_title(userid)" />,
                  </tal:has_updated_author>
		  last updated		      
		  <span tal:replace="python: view.pretty_date(item.ModificationDate)" />
		</span>
		
	      </li>
	    </ol>

            <div class="oc-lineup-sorter" tal:define="many python: batch.start!=batch.end">
            
              <!-- we put pagination on the bottom of the page too -->
              <div metal:use-macro="here/@@nui_batch_macros/pagination"/>
              
              <div tal:replace="structure python: view.sort_widget_string(batch.start, batch.end, batch.sequence_length)" />

	    </div>
	  </div>	  

	</tal:got_results>
      </div>
    </div>
  </body>
</html>
x
