<tal:handle-request 
   replace="nothing"
   define="global fdata view/handle_request;">
  This could be used to return a variety of template friendly info
  regarding the processing of the form
</tal:handle-request>
<html metal:use-macro="here/@@standard_macros/master">
  <head>
    <title metal:fill-slot="title" tal:content="string:Team - ${view/area/Title}" />
  </head>
  <body>
    <div metal:fill-slot="content">

      <!-- batch needs to have some variables set up to work properly.
            here is where they are defined -->
      <tal:got_results condition="view/listed_members"
                       define="batch view/listed_members;
                               batch_base_url request/ACTUAL_URL;
                               start batch/start | nothing;
                               end batch/end | nothing;
                               sequence_length batch/sequence_length | nothing;
                               many python: start != end">
        <div class="oc-headingBlock">
          <h1>Team</h1>    
        </div>

        <!-- display the number of results that came back -->

        <div class="oc-searchresults-nresults oc-clearAfter">
          <!-- pagination uses the batch macro -->
          <div metal:use-macro="context/@@nui_batch_macros/pagination"/>
          <metal:selector use-macro="view/team_macros/macros/selector" />
        </div>

        <!-- non-pending results -->
        <ol class="oc-roster oc-clearAfter"
            tal:condition="python:view.selector != 'pending'">
          <form name="team-members" id="team-members" method="POST"
                tal:attributes="action view/request/ACTUAL_URL">
            <input type="hidden" name="selector"
                   tal:attributes="value view/selector" />
            <input type="hidden" name="b_start:int"
                   tal:condition="request/b_start | nothing"
                   tal:attributes="value request/b_start" />
            <tal:repeat repeat="member_record view/listed_membership_records">
              <metal:member-row use-macro="view/team_macros/macros/member-row" />
            </tal:repeat>
          </form>
        </ol>
        
        <!-- pending results -->
        <div class="oc-widget-activity"
             tal:condition="python:view.selector == 'pending'">
          <ul class="oc-feed-list">
            <tal:repeat repeat="member_record view/listed_membership_records">
              <metal:pending-member-row use-macro="view/team_macros/macros/pending-member-row" />
            </tal:repeat>
          </ul>
        </div>

        <div class="oc-searchresults-footer oc-clearAfter" tal:define="many python: start!=end">
          <!-- we put pagination on the bottom of the page too -->
          <div metal:use-macro="context/@@nui_batch_macros/pagination"/>

          <div metal:use-macro="view/team_macros/macros/search-results-summary" />
        </div>
      </tal:got_results>

      <tal:no_results define="sequence_length python:0;
                              many python:True"
                      condition="not: view/listed_members">
        <!-- if we get no results, this is what is displayed -->
        <metal:selector use-macro="view/team_macros/macros/selector" />
        <br /><br />
        <div class="oc-roster"
             i18n:translate="no-team-members">No team members found.</div>
      </tal:no_results>

    </div><!-- content-fill-slot -->

    <div metal:fill-slot="sidebar">
      <tal:can_invite condition="view/can_manage">
        <metal:invite-members use-macro="view/team_macros/macros/invite-members" />
      </tal:can_invite>
    </div><!-- content-sidebar -->
</body>
</html>
