<tal:macro metal:define-macro="item_row"
           tal:define="item item | options/item;
                       item_type item_type | options/item_type;
                       editable editable | not:item/uneditable | nothing; 
                       deletable not:item/undeletable | nothing">
  <tr class="oc-js-liveEdit" tal:attributes="id item/id">
    <td tal:condition="item/collection/editable | view/editable">
      <tal:if condition="not:deletable">
        <input type="checkbox" class="oc-js-checkAll-never" name="deletes:list"
               tal:attributes="value item/id" 
               disabled="True" />
      </tal:if>
      <tal:if condition="deletable">
        <input type="checkbox" name="deletes:list"
               tal:attributes="value item/id" />
      </tal:if>
    </td>
    <td>
      <div class="oc-js-liveEdit-value">
        <a tal:attributes="href item/url">
          <tal:dummy replace="item/title" />
        </a>
      </div>
      
      <div tal:condition="item/collection/editable | view/editable"
           class="oc-js-liveEdit-editForm  oc-liveEdit-editForm">
	<tal:if condition="editable" >  <!-- this is a hack. oh, this whole file is a hack. -->
          <input type="text" 
		 tal:attributes="name string:${item/id}_title;
				 value item/title" 
		 />
          <input type="submit" class="oc-js-actionButton" value="Save"
		 tal:attributes="name string:task|${item/id}|update" />
          or
          <a href="" class="oc-js-liveEdit_hideForm">
            Cancel
          </a>
	</tal:if>
      </div>
    </td>
    <td tal:condition="python:item_type!='pages'">
      <tal:dummy replace="item/obj_size" />
    </td>
    <td>
      <tal:dummy replace="item/obj_date" />
      <tal:setvar define="author item/obj_author" condition="author">
        by
        <a tal:attributes="href string:${view/siteURL}/people/${author}/profile">
          <tal:dummy replace="author" />
        </a>
      </tal:setvar>
    </td>
    <td tal:condition="item/collection/editable | view/editable">
      <ul class="oc-actions oc-dataTable-row-actions">
        <li tal:condition="editable">
        <a href="#" class="oc-js-liveEdit_showForm oc-actionLink">Rename</a></li>
        <li tal:condition="deletable">
          <a class="oc-js-actionLink oc-actionLink oc-js-confirm"
             tal:attributes="href string:contents?task|${item/id}|delete=Delete&item_type=${item_type}&authenticator=${view/authenticator}">
            Delete <span class="oc-hidden oc-warning">This deletion is permanant.  Are you sure you want to delete?</span>
          </a>
        </li>
      </ul>
    </td>
  </tr>
</tal:macro>
