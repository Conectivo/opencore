<tal:macro metal:define-macro="project_table">
  <tal:projects_table define="projinfos view/projects_for_user">
    <div id="project_table"
         class="oc-widget oc-widget-dataTable oc-clearAfter"
	 tal:condition="projinfos"
	 >
      <div class="oc-headingBlock">
	<h2 class="oc-toggleFold">
          Projects you belong to (<span id="num_projs" tal:content="python: len(projinfos)" />)
	</h2>
      </div><!-- end .headingBlock -->
      
      <form class="" action="preferences">
	<table id="" class="oc-dataTable" cellpadding="0" cellspacing="0">
	  <thead>
            <tr>
              <th class="" style="width: 10px;" scope="col"><input class="oc-checkAll" type="checkbox" /></th>
              <th class="oc-columnSortable" style="width: 200px;" scope="col">Project </th>
              <th class="oc-columnSortable" scope="col">Role</th>
              <th class="oc-columnSortable" scope="col">Since</th>
              <th class="oc-columnSortable" scope="col">Listed</th>
              <th class="oc-columnAction" scope="col">Actions</th>
            </tr>
	  </thead>
	  <tbody id="projinfos_for_user">
            <tal:for repeat="projinfo projinfos">
              <tal:var define="proj_id projinfo/proj_id">
		<tal:macro metal:use-macro="view/project_row/macros/project_row" />
              </tal:var>
            </tal:for>
	  </tbody>
	</table>
	<ul class="oc-actions oc-dataTable-actions">
	  <li>
            <button type="submit" name="task" value="batch:check_leave"
                    class="oc-button oc-chooseThis oc-js-actionButton">Leave projects</button>
	  </li>
	  <noscript>
	    <li>
              <button type="submit" name="task" value="batch:check_change-listing"
                      class="oc-button">Change listing</button>
	    </li>
	  </noscript>
	</ul>
      </form>
    </div><!-- end .widget-table -->
    
    <!-- XXX -->
    <h1 id="project_table" tal:condition="not: projinfos">Display anything with no projects? Maybe a link to join?</h1>
    
  </tal:projects_table>
</tal:macro>
