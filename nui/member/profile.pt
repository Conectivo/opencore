<tal:vars define="data view/viewed_member_info">

<html metal:use-macro="here/@@standard_macros/master">
  <body>
    <div metal:fill-slot="content">
      <div id="oc-content-main">
        <div id="oc-member-badge" class="oc-boxy oc-clearAfter vcard">
          <div class="oc-avatar">
            <img class="photo" tal:attributes="src data/portrait_url" />
          </div>
          <div class="oc-member-details">
            <div class="oc-headingBlock">
              <h1 class="fn" tal:content="data/id" />
              <p class="oc-member-fullname n" tal:content="data/fullname"></p>
              
              <p class="oc-headingContext oc-discreetText">
                member since <span tal:replace="data/membersince" />,
                last login <span tal:replace="data/lastlogin" />
              </p>
            </div>
            <dl class="oc-member-info">
              <tal:location tal:condition="data/location">
                <dt>Location <a class="oc-actionLink" href="profile-edit#location">Edit</a></dt>
                <dd class="adr" tal:content="data/location" />
              </tal:location>
              <dt>Projects</dt>
              <dd>
                <tal:projects condition="data/projects">
                  <ul class="oc-inlineList">
                    <li tal:repeat="proj data/projects"><a
                        tal:attributes="href proj/getURL"
                        tal:content="proj/Title" /><tal:private
                        condition="python: proj.review_state == 'closed'">
                        (private)</tal:private></li>
                  </ul>
                </tal:projects>
                <tal:noprojects condition="not: data/projects">
                  none
                  <span tal:condition="view/viewingself">
                    <a tal:attributes="href string:${view/siteURL}/projects">Get involved</a>
                  </span>
                </tal:noprojects>
              </dd>
              <dt>OpenPlans Home</dt>
              <dd><a class="url" href="http://www.openplans.org/people/">http://www.openplans.org/people/<span tal:replace="data/id" /></a></dd>
            </dl>
          </div>
        </div>

        <dl class="oc-member-info"
          tal:define="skills python: data['skills']      #instead use the following when tagger is ready: view.viewed_member_profile_tags('skills');
                      affils python: data['affiliations']#instead use the following when tagger is ready: view.viewed_member_profile_tags('affiliations');
                      favs   python: data['favorites']   #instead use the following when tagger is ready: view.viewed_member_profile_tags('favorites');">

          <span tal:replace="structure python:
            view.field_snippet(title='Personal Statement',
                               value=data.get('statement'),
                               anchor='personal-statement')" />
          <span tal:replace="structure python:
            view.field_snippet(title='Background',
                               value=data.get('background'),
                               anchor='background')" />
          <span tal:replace="structure python:
            view.field_snippet(title='Skills/Interests',
                               value=skills,
                               anchor='skills')" />
          <span tal:replace="structure python:
            view.field_snippet(title='Affiliations',
                               value=affils,
                               anchor='affiliations')" />
          <span tal:replace="structure python:
            view.field_snippet(title='Favorites',
                               value=favs,
                               anchor='favorites')" />

        </dl>
      </div><!-- end #oc-content-main -->

      <div id="oc-content-sidebar">
        <div class="oc-boxy">
          <h2>Recent activity</h2>
          <div class="oc-widget oc-widget-lastModified">
            <div class="oc-headingBlock">
              <h3>Pages last modified</h3>
            </div><!-- end .oc-headingBlock -->
            <table class="oc-dataTable" cellpadding="0" cellspacing="0">
              <thead>
                <tr>
                  <th scope="col">Date</th>
                  <th scope="col">Page</th>
                </tr>
              </thead>
              <tbody>
                <tr tal:repeat="item view/activity">
                  <td tal:content="item/date" class="oc-lastModified-date" />
                  <td class="oc-lastModified-title"><a tal:attributes="href item/url" tal:content="item/title" /></td>
                </tr>
              </tbody>
            </table>
          </div><!-- end .oc-widget-lastModified -->
        </div><!-- end .oc-boxy -->
      </div><!-- end .oc-content-sidebar -->
    </div><!-- content-fill-slot -->
  </body>
</html>
</tal:vars>
