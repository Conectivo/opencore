<tal:handle-request 
  replace="nothing"
  define="global fdata view/handle_request;">
  This could be used to return a variety of template friendly info
  regarding the processing of the form
</tal:handle-request>

<tal:vars define="usr view/viewedmember;
                  data view/viewed_member_info">

<html metal:use-macro="here/@@standard_macros/master">
  <body>
    <div metal:fill-slot="content">
      <div id="oc-content-main">
        <!--
        <form name="profile_form" id="profile_form" method="post" class="oc-member-edit oc-liveForm"
              tal:attributes="action string:${view/name}">
        -->
        <form name="profile_form" id="profile_form" method="post" class="oc-member-edit"
              tal:attributes="action string:${view/name}">
          <div id="oc-member-badge" class="oc-boxy oc-clearAfter">
            <div class="oc-member-editimage">
              <div class="oc-avatar" id="oc-profile-avatar">
                <img tal:attributes="src data/portraiturl" />
                <fieldset class="oc-expander" style="clear: left;">
                  <legend class="oc-legend-label">
                    <a href="#" class="oc-expander-link">Change image</a>
                  </legend>
                  <div class="oc-expander-content">
                    <input type="file" size="14" /><br />
                    <button type="submit" name="task" value="oc-profile-avatar_uploadAndUpdate">Update</button> or <a href="#">remove image</a>
                  </div>
                </fieldset>
              </div>
            </div>
            <fieldset>
              <div class="oc-headingBlock">
                <h1 class="fn" tal:content="usr/getId" />
                <p class="oc-headingContext oc-discreetText">
                  member since <span tal:replace="data/membersince" />,
                  last online <span tal:replace="data/lastlogin" />
                </p>
              </div>
              <ul class="oc-plainList">
                <li>
                  <label for="fullname">Full name</label><br />
                  <input type="text" id="fullname" name="fullname"
                    tal:attributes="value request/fullname | usr/getFullname" />
                </li>
                <li>
                  <label for="location">Location</label><br />
                  <input type="text" id="location" name="location"
                    tal:attributes="value request/location | usr/getLocation" />
                </li>
              </ul>
            </fieldset>
          </div>
          <fieldset>
            <label for="">Personal Statement</label><br />
            <textarea rows="3" cols="80" name="statement"
              tal:content="request/statement | usr/getStatement"></textarea>
            <label for="">Skills/Interests</label><br />
            <textarea rows="1" cols="80" name="skills"
              tal:content="request/skills | usr/getSkills"></textarea>
            <label for="">Affiliations</label><br />
            <textarea rows="1" cols="80" name="affiliations"
              tal:content="request/affiliations | usr/getAffiliations"></textarea>
            <label for="">Background</label><br />
            <textarea rows="1" cols="80" name="background"
              tal:content="request/background | usr/getBackground"></textarea>
            <label for="">Favorites</label><br />
            <textarea rows="1" cols="80" name="favorites"
              tal:content="request/favorites | usr/getFavorites"></textarea>
          </fieldset>

          <ul class="oc-actions oc-wiki-actions">
            <li>
              <!--
              <button type="submit"
                name="task"
                value="this_noAjax"
                class="oc-button oc-chooseThis">
                Update
              </button>
              -->
              <button type="submit"
                name="update"
                value="boolean:true"
                class="oc-button oc-chooseThis">
                Update
              </button>
            </li>
          </ul> 
        </form>
      </div><!-- end #oc-content-main -->

      <div id="oc-content-sidebar">
        <div class="oc-headingBlock">
          <h2>Recent activity</h2>
        </div>
        <div class="oc-widget oc-widget-lastModified">
          <div class="oc-headingBlock">
            <h3>Pages last modified</h3>
          </div><!-- end .oc-headingBlock -->
          <table class="oc-table" cellpadding="0" cellspacing="0">
            <thead>
              <tr>
                <th scope="col">Date</th>
                <th scope="col">Page</th>
              </tr>
            </thead>
            <tbody>
              <tr tal:repeat="item view/activity">
                <td tal:content="item/date" />
                <td><a tal:attributes="href item/url" tal:content="item/title" /></td>
              </tr>
            </tbody>
          </table>
        </div><!-- end .oc-widget-lastModified -->
      </div><!-- end .oc-content-sidebar -->
    </div><!-- content-fill-slot -->
  </body>
</html>
</tal:vars>
