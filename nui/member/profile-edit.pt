<!-- tal:handle-request 
  replace="nothing"
  define="global fdata view/handle_request;">
  This could be used to return a variety of template friendly info
  regarding the processing of the form
</tal:handle-request -->

<tal:vars define="usr view/viewedmember;
                  memberdata view/viewed_member_info">

<html metal:use-macro="here/@@standard_macros/master">
  <body>
    <div metal:fill-slot="content">
      <div id="oc-content-main">
        <!-- TODO make this conditional on first login
        <div class="oc-getstarted oc-boxy" style="position: relative;">
          <h1>Welcome to OpenPlans!</h1>
          <p class="oc-bigText">Please take a moment to fill out your profile or continue to <a href="">The Project that Invited You</a>.</p>
          <a href class="oc-actionClose oc-actionLink">close</a>
        </div>
        -->
        <form name="profile_form" id="profile_form" method="post" class="oc-member-edit" action="profile-edit" enctype="multipart/form-data">
          <div id="oc-member-badge" class="oc-boxy oc-clearAfter">
            <div class="oc-member-editimage">
              <div metal:use-macro="view/portrait_snippet/macros/portrait" />
            </div>
            <fieldset>
              <div class="oc-headingBlock">
                <h1 class="fn" tal:content="memberdata/id" />
                <p class="oc-headingContext oc-discreetText">
                  member since <span tal:replace="memberdata/membersince" />,
                  last online <span tal:replace="memberdata/lastlogin" />
                </p>
              </div>
              <ul class="oc-plainList">
                <li>
                  <label for="fullname">Full name</label><br />
                  <input type="text" id="fullname" name="fullname"
                    class="oc-autoFocus"
                    tal:condition="python: request.form.get('field') == 'fullname'"
                    tal:attributes="value request/fullname | memberdata/fullname" />
                  <input type="text" id="fullname" name="fullname"
                    tal:condition="python: request.form.get('field') != 'fullname'"
                    tal:attributes="value request/fullname | memberdata/fullname" />
                </li>
                <li>
                  <label for="location">Location</label><br />
                  <input type="text" id="location" name="location"
                    class="oc-autoFocus"
                    tal:condition="python: request.form.get('field') == 'location'"
                    tal:attributes="value request/location | memberdata/location" />
                  <input type="text" id="location" name="location"
                    tal:condition="python: request.form.get('field') != 'location'"
                    tal:attributes="value request/location | memberdata/location" />
                </li>
              </ul>
            </fieldset>
          </div>
          <fieldset>

            <label for="statement">Personal Statement</label><br />
            <textarea rows="3" cols="80" name="statement" id="statement"
              class="oc-autoFocus"
              tal:condition="python: request.form.get('field') == 'statement'"
              tal:content="request/statement | memberdata/statement"></textarea>
            <textarea rows="3" cols="80" name="statement" id="statement"
              tal:condition="python: request.form.get('field') != 'statement'"
              tal:content="request/statement | memberdata/statement"></textarea>

            <label for="background">Background</label><br />
            <textarea rows="1" cols="80" name="background" id="background"
              class="oc-autoFocus"
              tal:condition="python: request.form.get('field') == 'background'"
              tal:content="request/background | memberdata/background"></textarea>
            <textarea rows="1" cols="80" name="background" id="background"
              tal:condition="python: request.form.get('field') != 'background'"
              tal:content="request/background | memberdata/background"></textarea>

            <label for="skills">Skills/Interests</label><br />
            <textarea rows="1" cols="80" name="skills" id="skills"
              class="oc-autoFocus"
              tal:condition="python: request.form.get('field') == 'skills'"
              tal:content="request/skills | memberdata/skills"></textarea>
            <textarea rows="1" cols="80" name="skills" id="skills"
              tal:condition="python: request.form.get('field') != 'skills'"
              tal:content="request/skills | memberdata/skills"></textarea>

            <label for="affiliations">Affiliations</label><br />
            <textarea rows="1" cols="80" name="affiliations" id="affiliations"
              class="oc-autoFocus"
              tal:condition="python: request.form.get('field') == 'affiliations'"
              tal:content="request/affiliations | memberdata/affiliations"></textarea>
            <textarea rows="1" cols="80" name="affiliations" id="affiliations"
              tal:condition="python: request.form.get('field') != 'affiliations'"
              tal:content="request/affiliations | memberdata/affiliations"></textarea>

            <label for="favorites">Favorites</label><br />
            <textarea rows="1" cols="80" name="favorites" id="favorites"
              class="oc-autoFocus"
              tal:condition="python: request.form.get('field') == 'favorites'"
              tal:content="request/favorites | memberdata/favorites"></textarea>
            <textarea rows="1" cols="80" name="favorites" id="favorites"
              tal:condition="python: request.form.get('field') != 'favorites'"
              tal:content="request/favorites | memberdata/favorites"></textarea>

          </fieldset>

          <ul class="oc-actions oc-wiki-actions">
            <li>
              <input type="submit" 
                     name="task|update"
                     value="Update"
                     class="oc-button oc-chooseThis" />
            </li>
          </ul> 
        </form>
      </div><!-- end #oc-content-main -->

      <div id="oc-content-sidebar">
        <div class="oc-boxy">
          <h2>Recent activity</h2>
          <div class="oc-widget oc-widget-lastModified">
            <div class="oc-headingBlock">
              <h3>Pages last modified</h3>
            </div><!-- end .oc-headingBlock -->
            <table class="oc-dataTable" cellpadding="0" cellspacing="0">
              <thead>
                <tr>
                  <th scope="col">Date</th>
                  <th scope="col">Page</th>
                </tr>
              </thead>
              <tbody>
                <tr tal:repeat="item view/activity">
                  <td tal:content="item/date" class="oc-lastModified-date" />
                  <td class="oc-lastModified-title"><a tal:attributes="href item/url" tal:content="item/title" /></td>
                </tr>
              </tbody>
            </table>
          </div><!-- end .oc-widget-lastModified -->
        </div><!-- end .oc-boxy -->
      </div><!-- end .oc-content-sidebar -->
    </div><!-- content-fill-slot -->
  </body>
</html>
</tal:vars>
