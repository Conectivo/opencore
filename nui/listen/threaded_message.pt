<html metal:use-macro="here/@@standard_macros/master">
  <body>
    <div metal:fill-slot="content">
      <div id="oc-content-main">
        <div id="message_view" tal:define="message nocall:view">
          <!-- TODO
          <metal:message use-macro="here/message_macros/macros/message"/>
          -->
        </div>
        <ul id="thread-navigation"
          tal:define="next_link view/getNextInThread;
                      prev_link view/getParentMessage;
                      next_date view/getNextByDate;
                      prev_date view/getPreviousByDate;
                      replies view/getReplies;">
          <li tal:condition="replies">
            <dl id="thread-replies">
              <dt i18n:translate="label_threadreplies">
                Replies:
              </dt>
              <dd>
                <ul id="mail-reply-list">
                  <li tal:repeat="reply replies">
                    <a href="#" i18n:translate="" tal:content="reply/subject"
                      tal:attributes="href reply/url">Subject</a>
                    <span i18n:translate="label_author" tal:omit-tag="">by</span>
                    <span tal:replace="reply/mail_from">Author</span>
                  </li>
                </ul>
              </dd>
            </dl>
          </li>
          <li tal:condition="prev_link">
            <span id="thread-previous" i18n:translate="label_thread_reply">
              In reply to:
            </span>
            <a href="#" i18n:translate="" tal:content="prev_link/subject"
              tal:attributes="href prev_link/url">Subject</a>
            <span i18n:translate="label_author" tal:omit-tag="">by</span>
            <span tal:replace="prev_link/mail_from">Author</span>
          </li>
          <li tal:condition="next_link">
            <span id="thread-next" i18n:translate="label_mail_thread_next">
              Next in thread:
            </span>
            <a href="#" tal:content="next_link/subject" i18n:translate="" 
              tal:attributes="href next_link/url">Subject</a>
            <span i18n:translate="label_author" tal:omit-tag="">by</span>
            <span tal:replace="next_link/mail_from">Author</span>
          </li>
          <li tal:condition="next_date">
            <span id="date-next" i18n:translate="label_date_next">
              Next by date:
            </span>
            <a href="#" tal:content="next_date/subject" i18n:translate="" 
              tal:attributes="href  next_date/url">Subject</a>
            <span i18n:translate="label_author"
              tal:omit-tag="">by</span>
            <span tal:replace="next_date/mail_from">Author</span>
          </li>
          <li tal:condition="prev_date">
            <span id="date-prev" i18n:translate="label_date_prev">Previous by date:</span>
            <a href="#" tal:content="prev_date/subject" i18n:translate="" 
              tal:attributes="href prev_date/url">Subject</a>
            <span i18n:translate="label_author" tal:omit-tag="">by</span>
            <span tal:replace="prev_date/mail_from">Author</span>
          </li>
          <tal:remove replace="nothing">
            <!-- We probably don't need the whole thread here but this is how you would do it -->
            <li id="full-thread" tal:condition="local_thread"
              tal:define="thread view/getReplyStructure;
                          local_thread thread/children">
              <dl>
                <dt i18n:translate="label_threaded_replies">
                  Threaded Replies:
                </dt>
                <dd>
                  <!-- TODO
                  <div metal:use-macro="here/message_macros/macros/thread" />
                  -->
                </dd>
              </dl>
            </li>
          </tal:remove>
        </ul>
        <a id="to_threaded" href="." tal:attributes="href string:${view/folderURL}/by_thread"
          i18n:translate="">Return to threaded listing</a>
        <a id="to_flat" href="." tal:attributes="href string:${view/folderURL}/by_date"
          i18n:translate="">Return to flat listing</a>
      </div>
    </div>
  </body>
</html>
