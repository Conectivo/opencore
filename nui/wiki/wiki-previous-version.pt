<html metal:use-macro="here/@@standard_macros/master">
  <body>

    <!-- FIXME something needs to indicate tag / breadcrumbs ? --> 

    <div metal:fill-slot="content">
      <div id="oc-content-main" class="oc-content-main-fullWidth">
	<div class="oc-wiki">
	  <tal:let define="people_url python:here.portal_membership.getMembersFolder().absolute_url();
			   version_id python:int(request['version_id']); 
			   version python:view.get_version(version_id);
			   cur_id python: view.current_id();
			   previous_id python: view.previous_id(version_id); 
			   next_id python: view.next_id(version_id);" >

	    <div class="oc-headingBlock oc-wiki-headingBlock">
              <h2 tal:content="view/pagetitle"></h2>
            </div>
            <div metal:use-macro="here/@@wiki_macros/tabs"/>

              <div class="oc-widget oc-widget-version-compare">
                <table cellpadding="0" cellspacing="0" border="0"> 
                  <tr>
                    <td>
                      <tal:if condition="python: previous_id is not None">
                      <a class="oc-button oc-smallText" tal:attributes="href string:version?version_id=${previous_id}">&lt;</a>
                      </tal:if>
                
                      <tal:if condition="python: previous_id is None">
                     
                      </tal:if>
                    </td>
                    <td>
                      <span tal:replace="python: view.version_title(version_id);" />
                    </td>
                    <td>
                      <tal:if condition="python: next_id is not None">
                      <a class="oc-button oc-smallText" tal:attributes="href string:version?version_id=${next_id}">&gt;</a>
                      </tal:if>
                      <tal:if condition="python: next_id is None">
                      
                      </tal:if>
                    </td>
                      <td>
                        by <a tal:define="author version/sys_metadata/principal" 
                                tal:attributes="href string:${people_url}/${author}"
                                tal:content="author">author</a>, 
                        <span tal:replace="python:view.pretty_mod_date(version)" />
                      </td>
                  </tr>
                  <tal:if condition="python: version_id != view.current_id()">
                  <tr>
                    <td colspan="4">
                      <a tal:attributes = "href string:version_compare?version_id=${version_id}&version_id=${cur_id}">compare with current version</a>
                    </td>
                  </tr>
                  </tal:if>
                </table>
                 <tal:if condition="python: version_id != view.current_id()">
                  <ul class="oc-actions">
                    <li>
                      <!-- FIXME ? relative --> 
                      <form method="post" id="revert_form" action="revertversion">
                      <input type="hidden" name="version_id" tal:attributes="value version_id" />
                                  <input type="submit" name="revert" value="revert to this version" />
                      </form> 
                    </li>
                  </ul>
                  </tal:if>
                <hr class="oc-clearElement" />
              </div><!-- .oc-widget-version-compare -->
              
          
             
              
              <span tal:replace="version/comment" />
              
            
	    <span tal:replace="structure python: view.get_page(version_id).EditableBody()" />

	  </tal:let>	    
	</div> <!-- end .oc-wiki --> 
      </div> <!-- end #oc-content-main -->
    </div><!-- end content slot -->
  </body>
</html>
	