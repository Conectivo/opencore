<html metal:use-macro="here/@@standard_macros/master">
  <head>
    <link metal:fill-slot="link" />
    <script metal:fill-slot="script" />
  </head>
  <body>

    <!-- FIXME something needs to indicate tag / breadcrumbs ? --> 
    
    <div metal:fill-slot="content">
      <div id="oc-content-main">
	<div class="oc-wiki">

	  <tal:let define="people_url python:here.portal_membership.getMembersFolder().absolute_url();
			   old_id view/old_version_id;
			   new_id view/new_version_id;
			   prev_old_id python: view.previous_id(old_id);
			   next_old_id python: view.next_id(old_id);
			   prev_new_id python: view.previous_id(new_id); 
			   next_new_id python: view.next_id(new_id);            
			   ">

	    <!-- FIXME this shouldn't be repeated everywhere --> 
            <div class="oc-headingBlock oc-wiki-headingBlock">
              <h2 tal:content="view/pagetitle"></h2>
            </div>
            <ul class="oc-tabs">
              <li class="">
		<a href="@@index.html" rel="view">view</a>
              </li>
              <li>
		<a href="" rel="edit">edit</a>
              </li>
              <li>
		<a href="" class="oc-selected" rel="history">history</a>
              </li>
              <!--<li tal:condition="nothing">-->
              <li>
		<form class="" >
                  <select class="oc-dropdown-links">
                    <option value="">More...</option>
                    <option value="http://www.google.com">I'm feeling lucky</option>
                  </select>
                  <input type="submit" value="Go" style=""/>
		</form>
              </li>
            </ul><!-- end .oc-tabs -->
	    <!-- FIXME --> 
            


            <div class="oc-headingBlock">

              <!-- <h1>Compare Versions: <span tal:replace="here/title_or_id">page</span></h1> --> 

              <p class="oc-headingContext">

		Comparing 
		
		<!-- FIXME prev widget --> 
		<tal:if condition="view/new_prev_enabled">
		  <a tal:attributes="href string:version_compare?version_id=${old_id}&version_id=${prev_new_id}">
                    &larr;<!-- FIXME -->
		  </a>
		</tal:if>
		<tal:if condition="not: view/new_prev_enabled">
		  &larr;<!-- FIXME -->
		</tal:if>&nbsp; 

		<a tal:attributes="href string:version?version_id=${new_id}">
		  <span tal:replace="python: view.version_title(new_id);" />
		</a>


		<!-- FIXME next widget --> 
		&nbsp;<tal:if condition="view/new_next_enabled">
		  <a tal:attributes="href string:version_compare?version_id=${old_id}&version_id=${next_new_id}">
                    &rarr;<!-- FIXME -->
		  </a>
		</tal:if>
		<tal:if condition="not: view/new_next_enabled">
		  &rarr;<!-- FIXME -->
		</tal:if>

		by <a tal:define="author view/new_version/sys_metadata/principal" 
                      tal:attributes="href string:${people_url}/${author}"
                      tal:content="author">author</a>, 
		<span tal:replace="python: view.pretty_mod_date(view.new_version)" />
		
		<!--    Other Version     --> 
		
		<br/>to 

		<!-- FIXME prev widget --> 
		<tal:if condition="view/old_prev_enabled">
		  <a tal:attributes="href string:version_compare?version_id=${prev_old_id}&version_id=${new_id}">
                    &larr;<!-- FIXME -->
		  </a>
		</tal:if>
		<tal:if condition="not: view/old_prev_enabled">
		  &larr;<!-- FIXME -->
		</tal:if>&nbsp;
		

		<a tal:attributes="href string:version?version_id=${old_id}">
		  <span tal:replace="python: view.version_title(old_id);" /> 
		</a>

		<!-- FIXME next widget --> 
		&nbsp;<tal:if condition="view/old_next_enabled">
		  <a tal:attributes="href string:version_compare?version_id=${next_old_id}&version_id=${new_id}">
                    &rarr;<!-- FIXME -->
		  </a>
		</tal:if>
		<tal:if condition="not: view/old_next_enabled">
		  &rarr;<!-- FIXME -->
		</tal:if>
		
		by <a tal:define="author view/old_version/sys_metadata/principal" 
                      tal:attributes="href string:${people_url}/${author}"
                      tal:content="author">author</a>, 
		<span tal:replace="python:view.pretty_mod_date(view.old_version)" />

              </p>


              <!-- FIXME: probably this floaty thing should be redone -->
              <div style="float: right">
		Legend:
		<ul>
		  <li><del>deleted</del></li>
		  <li><ins>inserted</ins></li>
		</ul>
              </div>
            </div> <!-- end .oc-headingBlock --> 
            
            <span tal:replace="structure view/html_diff" />
            
	  </tal:let>
	</div> <!-- end .oc-wiki --> 
      </div> <!-- end #oc-content-main --> 
    </div><!-- end content slot -->
  </body>
</html>
